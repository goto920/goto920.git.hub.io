<HTML>
<HEAD>
<title>KG's 速度/ピッチ可変プレーヤ</title>
<META charset="utf-8">
</HEAD>
<BODY>

<h1>KG's 速度/ピッチ可変音楽プレーヤ</h1>

<P>
React でsoundtouchjs module を使って作りました。
<BR>
<B>☆インストールの必要なし☆</B>
<BR>
でファイルサイズは700kB以下です。
</P>
<P>
一度使うと自動的に保存され、オフラインでも使えるはずです。
気にいったらスマートフォンのホーム画面に追加してください。
</P>

以下のスクリーンショットをクリックしてつかってください。

<HR>
iPhoneでうまく動かないので動作確認中
<A HREF="20200331">20200331</A>(テスト中)
<HR>
<H2>0. 動作確認</H2>

<UL>
<LI>Linux PCのWebブラウザ (Firefox) -- OK
<LI>Windows10 PCのWebブラウザ(Edge)
<LI>Apple PC (最新macOS) のWebブラウザ(Safari)
<LI>Android(ちょっと古い)のWebブラウザ (mobile Chrome)
<LI>iPhone (最新iOS) のWebブラウザ (mobile Safari) -- 不具合発見
</UL>

それ以外の機器では確認できませんが、動く可能性は十分あります。
iOSは動きにクセがあります。

<HR>
<H2>1. 機能</H2>

<OL>
<LI>基本機能
<UL>
<LI>機器やクラウドストレージに保存された音楽ファイルを読み込んで、
再生速度を変えて再生できる (25から200%) 
<LI>音程も細かく変更できる -- 半音単位と半音の1/100 (cents)
</UL>
<LI>応用再生機能
<UL>
<LI>途中からの再生
<LI>ABループ再生、間隔を指定できる (default 2秒)
</UL>
<LI>保存機能
<UL>
<LI>再生速度、音程を変更したファイル (曲開始から終了まで)をダウンロード
<LI>再生しながら記録するので遅い (技術的課題)
-- 例えば5分の曲を50%速度にすると10分必要 (技術的課題)
<LI>iOS (iPhone) では保存時にファイル名と拡張子が付かない (unknownになる)。
保存後にファイル名に.wavを追加しないと再生できない (iOSの仕様の問題)
</UL>
</OL>

<HR>

<H2>使い方</H2>

<P>
wav、mp3などの音楽ファイルを用意しておく必要があります。
読み込めるファイルの種類は機器によって異なりますが、wavとmp3はまず
大丈夫です。
</P>

iPhoneではmobile Safariで読み込めるフォルダが限定されているので、
確実に読めるiCloud Driveに音楽ファイルを用意しておくとよいでしょう。

<UL>
<LI>1) Input Audio -- 参照を押して音楽ファイル(wav, mp3など)を探して読み込む 
<UL>
<LI>読み込みに成功すると2)の「LoadFile!」ボタン が 「PlayFromA」に変わる
</UL>
<LI>2) 通常再生 「PlayFromA」 -- 「Pause」に変わる
<UL>
<LI>Aが0になっていれば最初から再生
<LI>「Pause」(一時停止) を押すとAがその時間に変わる
<LI>「PlayFromA」で続きが再生できる
<LI>時間スライダで時間を変更して「SetA」を押して、再生開始時間を設定できる
</UL>
<LI>再生速度変更: テンポスライダで調整 (再生中に変更可)
<LI>ピッチ(音程変更)
<UL>
<LI>上のスライダは半音単位 (semitone)
<LI>下のスライダは半音の1/100単位 (cents) -- 微調整
</UL>
<LI>音量調整: Volumeスライダ
<LI>2) リピート再生: 「LoopAB」を押す、「StopLoop」で停止
<BR>-- 「ResetAB」でAを0、Bを曲の終りにリセット
<UL>
<LI>再生中にsetA, setBを押す
<LI>または、時間のスライダを移動して「setA」と「setB」(BはAより後ろ)
</UL>
<LI>3) 保存: 「ExportWav」 (保存したい場合だけ使う)
<OL>
<LI>曲の再生が終わるまで待つ (すぐにしたいのですが未解決)
<BR> -- スロー再生にしたら、その分長くなります:-)
<LI>注意点
<UL>
<LI>音量を変えても、保存には影響なし (保存は100%音量)
<LI>設定した再生速度と音程は再生中に変更しない (変更が保存ファイルに反映される)
<LI>曲の再生が終ったらダウンロードできる (現在wavファイルのみ)
<LI>ファイル名は、"元のファイル名(.wavなし)&amp;s80\&amp;p1.wav" のように、
スピードとピッチの値を追加したものになるはずです。
<LI>ダウンロードしたファイルを保存する操作は機器により違うので注意
</UL>
</UL>

iPhoneでExportWavした場合、Blobという別ウィンドウが開きます。
ファイル名が自動的につかないので、unknownのままiCloudに保存して、
あとでファイル名を ".wav"の拡張子付きに変更しましょう。
保存時にファイル名が指定できるなら、そのときに変更してください。

<HR>
<P>
Source code (JavaScript and sound files)
<A HREF="https://github.com/goto920/nodejs/">
https://github.com/goto920/nodejs/</A>
</P>
<HR>
Contact: goto at kmgoto.jp
</BODY>
</HTML>
