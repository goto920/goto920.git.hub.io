(this.webpackJsonpvariablespeedplayer=this.webpackJsonpvariablespeedplayer||[]).push([[0],[,,function(e){e.exports=JSON.parse('{"name":"variablespeedplayer","version":"0.1.0","private":true,"homepage":".","subversion":"20210220-00","dependencies":{"audiobuffer-to-wav":"^1.0.0","file-saver":"^2.0.5","react":"^16.14.0","react-dom":"^16.14.0","react-scripts":"^3.4.4","soundtouchjs":"^0.1.26","whatwg-fetch":"^3.6.1"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"]}')},function(e){e.exports=JSON.parse('{"us":{"title":"KG\'s variable speed/pitch player","input":"Select audio file (local/cloud storage)","speed":"Speed(%)","reset":"Reset","pitch":"Pitch(semitone.cents)","time":"Time(sec)","timeNote":"(Start pos., A, B set)","setA":"setA","setB":"setB","resetAB":"ResetAB","volume":"Volume(%)","volumeNote":"(May change during export)","loadFile":"selectFile!","playOnce":"PlayOnce","pause":"Pause","rewind":"Rewind","loopAB":"loopAB","stopLoop":"StopLoop","interval":"interval(sec)","exportWav":"ExportAfterPlayback","abortExport":"AbortExport","resetAudio":"iOSAudioReset","version":"Version","guide":"guide/update","homepage":"https://goto920.github.io/demos/variableplayer/"},"ja":{"title":"KG\'s \u901f\u5ea6/\u97f3\u7a0b\u53ef\u5909\u30d7\u30ec\u30fc\u30e4","input":"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30d5\u30a1\u30a4\u30eb\u9078\u629e (\u30ed\u30fc\u30ab\u30eb/\u30af\u30e9\u30a6\u30c9)","speed":"\u901f\u5ea6(%)","reset":"\u30ea\u30bb\u30c3\u30c8","pitch":"\u97f3\u7a0b(\u534a\u97f3.\u534a\u97f3\u306e1/100)","time":"\u6642\u523b(\u79d2)","timeNote":"(\u518d\u751f\u958b\u59cb\u4f4d\u7f6e, A, B\u8a2d\u5b9a)","setA":"\u8a2d\u5b9aA","setB":"\u8a2d\u5b9aB","resetAB":"\u30ea\u30bb\u30c3\u30c8AB","volume":"\u97f3\u91cf(%)","volumeNote":"(\u66f8\u304d\u51fa\u3057\u4e2d\u5909\u66f4\u53ef)","loadFile":"\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u3093\u3067\u306d!","playOnce":"\u4e00\u56de\u518d\u751f","pause":"\u4e00\u6642\u505c\u6b62","rewind":"\u5dfb\u304d\u623b\u3057","loopAB":"AB\u30eb\u30fc\u30d7\u518d\u751f","stopLoop":"\u30eb\u30fc\u30d7\u505c\u6b62","interval":"\u9593\u9694(\u79d2)","exportWav":"\u518d\u751f\u5f8c\u66f8\u304d\u51fa\u3057","abortExport":"\u66f8\u304d\u51fa\u3057\u4e2d\u6b62","resetAudio":"iOS\u30aa\u30fc\u30c7\u30a3\u30aa\u30ea\u30bb\u30c3\u30c8","version":"\u7248","guide":"\u30ac\u30a4\u30c9/\u66f4\u65b0","homepage":"https://goto920.github.io/demos/variableplayer/index-jp.html"}}')},,,,,function(e,t,a){e.exports=a(16)},,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n,i,s,r=a(0),l=a.n(r),o=a(5),p=a.n(o),h=(a(13),a(14),a(1)),u=a(2),d=a(6),c=a(7),m=a(3),S=(u.homepage+u.subversion).slice(-11),g=m.ja,f=m.us;n="ja"===window.navigator.language.slice(0,2)?g:f,window.AudioContext=window.AudioContext||window.webkitAudioContext;var v=null;class y extends r.Component{constructor(e){super(e),this.params={filename:null,audioBuffer:null,isPlaying:!1,loop:!1,loopInterval:2,exportDataL:null,exportDataR:null,exportBuffer:null,save:!1},this.state={ja:n===g,playingAt:0,playingAtSlider:0,timeA:0,timeB:0,playSpeed:100,playPitch:0,playPitchSemi:0,playPitchCents:0,playVolume:75,startButtonStr:n.loadFile,loopButtonStr:n.loopAB,saveButtonStr:n.exportWav},this.setState=this.setState.bind(this),this.handleWindowClose=this.handleWindowClose.bind(this),this.loadFile=this.loadFile.bind(this),this.handleSpeedSlider=this.handleSpeedSlider.bind(this),this.handlePitchSlider=this.handlePitchSlider.bind(this),this.handleTimeSlider=this.handleTimeSlider.bind(this),this.handleVolumeSlider=this.handleVolumeSlider.bind(this),this.handlePlay=this.handlePlay.bind(this),this.handleSaveB=this.handleSaveB.bind(this),this.fakeDownload=this.fakeDownload.bind(this),this.handleLoop=this.handleLoop.bind(this),this.playAB=this.playAB.bind(this),this.handleLang=this.handleLang.bind(this)}handleWindowClose(e){v&&(v.disconnect(),v.off(),v=null,s.disconnect()),i.close()}componentDidMount(){(i=new window.AudioContext).audioWorklet?console.log("audioWorklet exists!"):console.log("audioWorklet not found"),s=i.createGain(),window.addEventListener("beforeClosing",this.handleWindowClose)}componentWillUnmount(){window.removeEventListener("beforeClosing",this.handleWindowClose)}render(){var e,t,a,i=this.loadFile,s=this.handleSpeedSlider,r=this.handlePitchSlider,o=this.handleVolumeSlider,p=this.handleTimeSlider,h=this.handlePlay,u=this.handleSaveB,d=this.handleLoop,c=this.handleLang,m=this.state,g=m.ja,f=m.playingAt,v=m.playingAtSlider,y=m.timeA,B=m.timeB,A=m.playSpeed,b=m.playPitch,E=m.playPitchSemi,w=m.playPitchCents,C=m.playVolume,P=m.startButtonStr,x=m.loopButtonStr,k=m.saveButtonStr,F=0;this.params.audioBuffer&&(F=this.params.audioBuffer.duration),e=P===n.pause?{color:"green"}:{},t=x===n.stopLoop?{color:"green"}:{},a=k===n.abortExport?{color:"green"}:{};var W={border:"1px dotted",color:"blue"};return l.a.createElement("div",{className:"App"},n.title," \xa0\xa0",l.a.createElement("span",{className:"small-button"},l.a.createElement("button",{name:"language",onClick:c},g?"En(US)":"\u65e5\u672c\u8a9e")),l.a.createElement("hr",null),"1) ",n.input,": ",l.a.createElement("br",null),l.a.createElement("span",{className:"selectFile"},l.a.createElement("input",{type:"file",name:"loadFile",accept:"audio/*",onChange:i}),l.a.createElement("br",null)),l.a.createElement("hr",null),n.speed,": ",A," \xa0\xa0",l.a.createElement("button",{name:"reset",onClick:s},n.reset),l.a.createElement("br",null),l.a.createElement("span",{className:"slider"},l.a.createElement("center",null,"025",l.a.createElement("input",{type:"range",name:"speedSlider",min:"25",max:"200",value:A,onChange:s}),"200")),l.a.createElement("hr",null),n.pitch,": ",parseFloat(b).toFixed(2)," \xa0\xa0",l.a.createElement("button",{name:"reset",onClick:r},n.reset),l.a.createElement("br",null),l.a.createElement("span",{className:"slider"},l.a.createElement("center",null,"-12",l.a.createElement("input",{type:"range",name:"pitchSliderSemi",min:"-12",max:"12",value:E,onChange:r}),"12",l.a.createElement("br",null),l.a.createElement("hr",{style:W}),"-100",l.a.createElement("input",{type:"range",name:"pitchSliderCents",min:"-100",max:"100",value:w,onChange:r}),"100",l.a.createElement("br",null))),l.a.createElement("hr",null),n.time,": ",f.toFixed(2)," \xa0 ",n.timeNote,l.a.createElement("br",null),l.a.createElement("span",{className:"slider"},l.a.createElement("center",null,"0",l.a.createElement("input",{type:"range",name:"timeSlider",min:"0",max:F,value:v,step:"1",onChange:p}),Math.round(F),l.a.createElement("br",null)),l.a.createElement("button",{name:"setA",onClick:d},n.setA),": ",y.toFixed(2)," \xa0\xa0",l.a.createElement("button",{name:"setB",onClick:d},n.setB),": ",B.toFixed(2)," \xa0\xa0",l.a.createElement("button",{name:"resetAB",onClick:d},n.resetAB)),l.a.createElement("hr",null),n.volume,": ",C," \xa0\xa0 ",n.volumeNote,l.a.createElement("br",null),l.a.createElement("span",{className:"slider"},l.a.createElement("center",null,"0",l.a.createElement("input",{type:"range",name:"volumeSlider",min:"0",max:"150",value:C,onChange:o}),"150",l.a.createElement("br",null))),l.a.createElement("hr",null),l.a.createElement("span",null,"2A) ",l.a.createElement("button",{name:"startPause",onClick:h,style:e},P)," \xa0\xa0",l.a.createElement("button",{name:"Rewind",onClick:d},n.rewind),l.a.createElement("hr",{style:W}),"2B) ",l.a.createElement("button",{name:"LoopAB",onClick:d,style:t},x)," \xa0\xa0",n.interval," ",l.a.createElement("span",{className:"selector"},l.a.createElement("select",{name:"loopInterval",defaultValue:this.params.loopInterval,onChange:d},l.a.createElement("option",{value:"0"},"00"),l.a.createElement("option",{value:"1"},"01"),l.a.createElement("option",{value:"2"},"02"),l.a.createElement("option",{value:"4"},"04"),l.a.createElement("option",{value:"5"},"05"),l.a.createElement("option",{value:"10"},"10"),l.a.createElement("option",{value:"20"},"20"),l.a.createElement("option",{value:"30"},"30"),l.a.createElement("option",{value:"60"},"60"))),l.a.createElement("hr",null),"3) ",l.a.createElement("button",{name:"save",onClick:u,style:a},k)),l.a.createElement("hr",null),n.version,": ",S,", \xa0",l.a.createElement("a",{href:n.homepage,target:"_blank",rel:"noopener noreferrer"},n.guide),l.a.createElement("br",null),"Based on ",l.a.createElement("a",{href:"https://github.com/cutterbl/SoundTouchJS",target:"_blank",rel:"noopener noreferrer"},"cutterbl/SoundTouchJS"))}loadFile(e){if("loadFile"===e.target.name&&0!==e.target.files.length&&!this.params.isPlaying){this.setState({totalTime:0}),this.setState({startButtonStr:n.playOnce});var t=e.target.files[0];this.params.filename=t.name;var a=new FileReader;a.onload=function(e){i.decodeAudioData(a.result,function(e){this.params.saudioBuffer=null,this.params.audioBuffer=e,this.setState({startButtonStr:n.playOnce,playingAt:0,playingAtSlider:0}),this.setState({timeA:0}),this.setState({timeB:e.duration})}.bind(this),(function(e){console.log("Filereader error: "+e.err)}))}.bind(this),a.readAsArrayBuffer(t)}}handleSpeedSlider(e){return"speedSlider"===e.target.name?(v&&(v.tempo=e.target.value/100),void this.setState({playSpeed:e.target.value})):"reset"===e.target.name?(v&&(v.tempo=1),void this.setState({playSpeed:100})):void 0}handlePitchSlider(e){var t=0;"pitchSliderSemi"===e.target.name?(t=parseFloat(e.target.value)+parseFloat(this.state.playPitchCents)/100,this.setState({playPitchSemi:e.target.value})):"pitchSliderCents"===e.target.name?(t=parseFloat(this.state.playPitchSemi)+parseFloat(e.target.value)/100,this.setState({playPitchCents:e.target.value})):"reset"===e.target.name&&(this.setState({playPitchSemi:0,playPitchCents:0}),t=0),v&&(v.pitch=Math.pow(2,t/12)),this.setState({playPitch:t})}handleTimeSlider(e){if("timeSlider"===e.target.name&&this.state.startButtonStr===n.playOnce){var t=e.target.value;this.setState({playingAt:parseFloat(t)}),this.setState({playingAtSlider:t})}}handleVolumeSlider(e){if("volumeSlider"===e.target.name){var t=1*e.target.value;s.gain.value=t/100,this.setState({playVolume:t})}}handlePlay(e){var t=this.params.audioBuffer;if("startPause"===e.target.name){var a,r;if("suspended"===i.state&&i.resume(),this.state.startButtonStr===n.pause){if(!this.params.isPlaying)return;if(null===v)return;return v.disconnect(),v.off(),v=null,s.disconnect(),this.params.isPlaying=!1,this.setState({playingAtSlider:this.state.playingAt}),void this.setState({startButtonStr:n.playOnce})}if("startPause"===e.target.name&&this.state.startButtonStr===n.playOnce){if(this.params.isPlaying)return;return a=this.state.playingAt,r=t.duration,void this.playAB(a,r)}}}fakeDownload(e){var t=this.params.filename.split(".")[0]+"&s"+parseInt(this.state.playSpeed)+"&p"+parseInt(100*this.state.playPitch)+".wav",a=new Blob([c(e)],{type:"audio/vnd.wav"});Object(d.saveAs)(a,t)}handleSaveB(e){if("save"===e.target.name&&this.state.startButtonStr===n.playOnce&&this.state.loopButtonStr===n.loopAB){var t=this.params.audioBuffer;if(this.state.saveButtonStr===n.abortExport)return v&&(v.disconnect(),v.off(),v=null,s.disconnect()),this.params.isPlaying=!1,void this.setState({saveButtonStr:n.exportWav});if(this.state.saveButtonStr===n.exportWav){if(this.params.isPlaying)return;if(!t)return;var a=null,r=t.numberOfChannels;v&&(v.disconnect(),v.off(),v=null);(v=new h.a(i,t,16384)).tempo=this.state.playSpeed/100,v.pitch=Math.pow(2,this.state.playPitch/12),a=i.createScriptProcessor(16384,r,r),this.params.exportBuffer=i.createBuffer(r,parseInt(t.length*(100/this.state.playSpeed))+16384,t.sampleRate),this.params.save=!0;var l=0;return AudioBuffer.prototype.copyToChannel?console.log("copyToChannel OK"):console.log("copyToChannel NG"),a.onaudioprocess=function(e){for(var t=e.inputBuffer,a=e.outputBuffer,n=this.params.exportBuffer,i=0;i<t.numberOfChannels;i++){var s=t.getChannelData(i),r=a.getChannelData(i),o=n.getChannelData(i);if(AudioBuffer.prototype.copyToChannel)a.copyToChannel(s,i,0),n.copyToChannel(s,i,l);else for(var p=0;p<t.length;p++){var h=s[p];r[p]=h,o[l+p]=h}}l+=t.length}.bind(this),v.on("play",e=>{var t=parseFloat(e.timePlayed);if(this.setState({playingAt:t,playingAtSlider:t}),e.formattedTimePlayed>=v.formattedDuration)return a.disconnect(),v.off(),v.disconnect(),v=null,s.disconnect(),this.fakeDownload(this.params.exportBuffer),this.params.isPlaying=!1,this.setState({saveButtonStr:n.exportWav}),void(this.params.save=!1)}),this.setState({saveButtonStr:n.abortExport}),this.params.isPlaying=!0,v.connect(a),a.connect(s),s.connect(i.destination),void("suspended"===i.state&&i.resume())}}}handleLoop(e){if("loopInterval"!==e.target.name){if("Rewind"===e.target.name){if(this.params.isPlaying)return;return this.setState({playingAt:0}),void this.setState({playingAtSlider:0})}if("setA"===e.target.name)return this.setState({timeA:this.state.playingAt}),void this.setState({playingAtSlider:this.state.playingAt});if("setB"!==e.target.name)if("LoopAB"!==e.target.name)if("resetAB"!==e.target.name);else{if(null===this.params.audioBuffer)return;this.setState({timeA:0,timeB:this.params.audioBuffer.duration,playingAtSlider:0})}else{if(!this.params.audioBuffer)return;if(this.state.loopButtonStr===n.loopAB){if(this.params.isPlaying)return;this.params.loop=!0,this.playAB(this.state.timeA,this.state.timeB),this.setState({loopButtonStr:n.stopLoop}),this.setState({startButtonStr:n.playOnce})}else if(this.state.loopButtonStr===n.stopLoop){if(!this.params.isPlaying)return;v&&(v.disconnect(),v.off(),v=null,s.disconnect()),this.params.isPlaying=!1,this.params.loop=!1,this.setState({loopButtonStr:n.loopAB})}}else this.state.playingAt>=this.state.timeA?this.setState({timeB:parseFloat(this.state.playingAt)}):this.setState({timeB:parseFloat(this.state.timeA)+parseFloat(10)})}else this.params.loopInterval=parseInt(e.target.value,10)}playAB(e,t){if(!this.params.isPlaying&&null!==this.params.audioBuffer){"suspended"===i.state&&i.resume(),t<=e&&(t=e+5,this.setState({timeB:t}));var a=this.params,r=a.audioBuffer,l=a.loopInterval,o=e*r.sampleRate,p=t*r.sampleRate,u=0;this.params.loop&&(u=l*r.sampleRate);var d=i.createBuffer(2,p-o+u,r.sampleRate),c=r.getChannelData(0),m=r.getChannelData(1);c=c.subarray(o,p);for(var S=d.getChannelData(0),g=0;g<c.length;g++)S[g+u]=c[g];if(r.numberOfChannels>=2){S=d.getChannelData(1),m=m.subarray(o,p);for(var f=0;f<m.length;f++)S[f+u]=m[f]}S=null;v&&(v.disconnect(),v.off(),v=null),v=new h.a(i,d,16384),d=null,v.tempo=this.state.playSpeed/100,v.pitch=Math.pow(2,this.state.playPitch/12);var y=v.formattedDuration;v.on("play",t=>{var a=parseFloat(e)+parseFloat(t.timePlayed);if(this.params.loop&&(a-=l),this.setState({playingAt:a,playingAtSlider:a}),t.formattedTimePlayed>=y)return v.off(),v.disconnect(),v=null,s.disconnect(),this.params.isPlaying=!1,this.state.startButtonStr===n.pause&&this.setState({playingAt:0,playingAtSlider:0,startButtonStr:n.playOnce}),void(this.params.loop&&this.playAB(this.state.timeA,this.state.timeB))}),v.connect(s),s.connect(i.destination),this.params.isPlaying=!0,this.params.loop||this.setState({startButtonStr:n.pause})}}handleLang(e){if(!this.params.isPlaying&&"language"===e.target.name){var t=n;return this.state.ja?(n=f,this.setState({ja:!1})):(n=g,this.setState({ja:!0})),this.state.startButtonStr===t.loadFile?this.setState({startButtonStr:n.loadFile}):this.state.startButtonStr===t.playOnce?this.setState({startButtonStr:n.playOnce}):this.state.startButtonStr===t.pause&&this.setState({startButtonStr:n.pause}),this.state.loopButtonStr===t.loopAB?this.setState({loopButtonStr:n.loopAB}):this.state.loopButtonStr===t.stopLoop&&this.setState({loopButtonStr:n.stopLoop}),void(this.state.saveButtonStr===t.exportWav?this.setState({saveButtonStr:n.exportWav}):this.state.saveButtonStr===t.abortExport&&this.setState({saveButtonStr:n.abortExport}))}}}var B=y,A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function b(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{var a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}p.a.render(l.a.createElement(B,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{var t="".concat(".","/service-worker.js");A?(!function(e,t){fetch(e).then(a=>{var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):b(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):b(t,e)})}}()}],[[8,1,2]]]);
//# sourceMappingURL=main.8cb72d72.chunk.js.map